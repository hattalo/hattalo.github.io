<html>
<head>
	<script type="text/javascript" src="http://www.airfrance.fr/FR/common/common/js/jquery.js"></script>
	<script type="text/javascript">
		var uriCourant = document.location.pathname;
		var hostCourant = document.location.host;
		
		var exprMM = new RegExp("[/][A-Z][A-Z][/][a-z][a-z][/]", "g");
		var resultMM = exprMM.test( uriCourant );
		var exprX00 = new RegExp("[/][A-Z][0-9][0-9][/][a-z][a-z][/]", "g");
		var resultX00 = exprX00.test( uriCourant );
		
		if( resultMM ) {
			//on est dans un marche, on affiche la page 404 du marche (si elle existe sinon la metapage)
			var resultat = uriCourant.match(exprMM);
			var marche = resultat[0].substr(1, 2);
			var langue = resultat[0].substr(4, 2);
			var urlCible = "http://"+hostCourant+"/"+marche+"/"+langue+"/local/transverse/system/Erreur404.html" ;
			$.ajax( { 
				url: urlCible ,
				success: function() {
					setTimeout( "window.location.href = urlCible", 0 );
				},
				error: function() {
					 setTimeout( "window.location.href = 'http://www.airfrance.com'", 0 );
				}
			});
		}
		else if( resultX00 ) {
			//on est dans un cluster, on tente de retrouver le marche dans la session
			var urlCible = "http://"+hostCourant+"/cgi-bin/AF/FR/fr/common/error/ErreurURLAction.do"
			setTimeout( "window.location.href = urlCible", 0 );
		}
		else {
			//Impossible de savoir ou on est
			setTimeout( "window.location.href = 'http://www.airfrance.com'", 0 );
		}
		
	</script>

</head>
</html>